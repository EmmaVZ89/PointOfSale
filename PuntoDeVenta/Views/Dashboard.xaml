<UserControl x:Class="PuntoDeVenta.Views.Dashboard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000"
             Background="Transparent">

    <UserControl.Resources>
        <!-- ESTILO TARJETA KPI -->
        <Style x:Key="KpiCard" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Margin" Value="0,0,15,0"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1" Color="#BDC3C7"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="KpiTitle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#7F8C8D"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style x:Key="KpiValue" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>
        
        <Style x:Key="BtnQuickAction" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="5" ShadowDepth="1" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="10" BorderBrush="#ECF0F1" BorderThickness="1">
                            <ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F7F9F9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Titulo -->
            <RowDefinition Height="120"/>  <!-- Tarjetas KPI -->
            <RowDefinition Height="*"/>    <!-- Grafico y Accesos -->
        </Grid.RowDefinitions>

        <!-- 1. TITULO -->
        <TextBlock Grid.Row="0" Text="Panel de Control" FontSize="28" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,20"/>

        <!-- 2. KPIs -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Card 1: Ventas Hoy -->
            <Border Grid.Column="0" Style="{StaticResource KpiCard}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Background="#E8F8F5" CornerRadius="50" Width="50" Height="50" VerticalAlignment="Center">
                        <Path Data="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12.89,11.1L12.5,11.5L11.5,12.5L11.1,12.89C10.7,12.5 10.5,12 10.5,11.5C10.5,10.67 11.17,10 11.5,10C12,10.5 12.5,10.7 12.89,11.1M17,12H19V17H5V12H7V9A5,5 0 0,1 12,4A5,5 0 0,1 17,9V12M7,12V9A5,5 0 0,1 12,4A5,5 0 0,1 17,9V12H7Z" 
                              Fill="#1ABC9C" Stretch="Uniform" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Ventas Hoy" Style="{StaticResource KpiTitle}"/>
                        <Viewbox Stretch="Uniform" HorizontalAlignment="Left" MaxHeight="35">
                            <TextBlock Name="lblVentasHoy" Text="$0.00" Style="{StaticResource KpiValue}" Foreground="#1ABC9C"/>
                        </Viewbox>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Card 2: Transacciones -->
            <Border Grid.Column="1" Style="{StaticResource KpiCard}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Background="#EBF5FB" CornerRadius="50" Width="50" Height="50" VerticalAlignment="Center">
                        <Path Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" 
                              Fill="#3498DB" Stretch="Uniform" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Transacciones" Style="{StaticResource KpiTitle}"/>
                        <Viewbox Stretch="Uniform" HorizontalAlignment="Left" MaxHeight="35">
                            <TextBlock Name="lblTransacciones" Text="0" Style="{StaticResource KpiValue}" Foreground="#3498DB"/>
                        </Viewbox>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Card 3: Productos Totales -->
            <Border Grid.Column="2" Style="{StaticResource KpiCard}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Background="#FEF9E7" CornerRadius="50" Width="50" Height="50" VerticalAlignment="Center">
                        <Path Data="M12,18H6V14H12M21,14V12L20,7H4L3,12V14H4V20H14V14H18V20H20V14M20,4H4V6H20V4Z" 
                              Fill="#F1C40F" Stretch="Uniform" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Productos" Style="{StaticResource KpiTitle}"/>
                        <Viewbox Stretch="Uniform" HorizontalAlignment="Left" MaxHeight="35">
                            <TextBlock Name="lblProductos" Text="0" Style="{StaticResource KpiValue}" Foreground="#F1C40F"/>
                        </Viewbox>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Card 4: Stock Bajo -->
            <Border Grid.Column="3" Style="{StaticResource KpiCard}" Margin="0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Background="#FDEDEC" CornerRadius="50" Width="50" Height="50" VerticalAlignment="Center">
                        <Path Data="M13,14H11V9H13M13,18H11V16H13M1,21H23L12,2L1,21Z" 
                              Fill="#E74C3C" Stretch="Uniform" Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Stock Bajo" Style="{StaticResource KpiTitle}"/>
                        <Viewbox Stretch="Uniform" HorizontalAlignment="Left" MaxHeight="35">
                            <TextBlock Name="lblStockBajo" Text="0" Style="{StaticResource KpiValue}" Foreground="#E74C3C"/>
                        </Viewbox>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- 3. GRAFICO Y ACCESOS -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/> <!-- Grafico -->
                <ColumnDefinition Width="20"/> <!-- Gap -->
                <ColumnDefinition Width="1.2*"/> <!-- Accesos -->
            </Grid.ColumnDefinitions>

            <!-- Grafico -->
            <Border Grid.Column="0" Background="White" CornerRadius="10" Padding="20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1" Color="#BDC3C7"/>
                </Border.Effect>
                <Grid>
                    <TextBlock Text="Tendencia Semanal de Ventas" FontSize="18" FontWeight="SemiBold" Foreground="#34495E" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                    
                    <lvc:CartesianChart Name="chartVentas" Margin="0,40,0,0" LegendLocation="None">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Fecha" Labels="{Binding FechasLabels}" Foreground="#7F8C8D"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Monto" LabelFormatter="{Binding Formatter}" Foreground="#7F8C8D"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>
                </Grid>
            </Border>

            <!-- Accesos Rapidos -->
            <StackPanel Grid.Column="2">
                <TextBlock Text="Accesos Rápidos" FontSize="18" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,15"/>
                
                <!-- Boton Nueva Venta (Para Todos) -->
                <Button x:Name="btnAccessPOS" Style="{StaticResource BtnQuickAction}" Height="80" Margin="0,0,0,15" Click="BtnNuevaVenta_Click">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" Fill="#2ECC71" Stretch="Uniform" Width="30" Height="30" HorizontalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Nueva Venta" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                            <TextBlock Text="Ir al Punto de Venta" FontSize="12" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Grid>
                </Button>

                <!-- Boton Inventario (Solo Admin) -->
                <Button x:Name="btnAccessInventario" Style="{StaticResource BtnQuickAction}" Height="80" Margin="0,0,0,15" Click="BtnMovimiento_Click">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Data="M7,10H12V15H7M19,19H5V8H19M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3Z" Fill="#3498DB" Stretch="Uniform" Width="30" Height="30" HorizontalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Inventario" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                            <TextBlock Text="Registrar Entrada/Salida" FontSize="12" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Grid>
                </Button>

                <!-- Boton Reportes (Solo Admin) -->
                <Button x:Name="btnAccessReportes" Style="{StaticResource BtnQuickAction}" Height="80" Margin="0,0,0,15" Click="BtnReportes_Click">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Data="M16,11.78L20.24,4.45L21.97,5.45L16.74,14.5L10.23,10.75L5.46,19H22V21H2V3H4V17.54L9.5,8L16,11.78Z" Fill="#E67E22" Stretch="Uniform" Width="30" Height="30" HorizontalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Reportes" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                            <TextBlock Text="Consultar Estadísticas" FontSize="12" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Grid>
                </Button>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
